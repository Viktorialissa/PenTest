#### Alisa Ahokas

# Lab kid
<!-- Up -->

#### Aloitetaan teht√§vien tekeminen üìÜ 15.11.2023 üïí 14.00 ja luetaan [teht√§v√§nanto](https://terokarvinen.com/2023/eettinen-hakkerointi-2023/#h4-totally-legit-sertificate).

# x)

## [A01:2021 ‚Äì Broken Access Control](https://owasp.org/Top10/A01_2021-Broken_Access_Control/)

Access control eli p√§√§synhallinta kontrolloi k√§ytt√§jien toimia niin, ett√§ he eiv√§t voi toimia laajemmin kuin tarkoitettu. Userina toimiminen, vaikka ei ole kirjautunut edes sis√§√§n tai adminina toimininen, vaikka on vaan user. Yleisimpi√§ virheit√§ access controlissa on pienimpien oikeuksien periaatteen noudattamatta j√§ttt√§minen. URL parametrien  tai API pyynt√∂jen muokkaaminen johtaen access controlin ohittamiseen. API:in p√§√§seminen k√§siksi niin, ett√§ voi k√§ytt√§√§ POST, PUT ja DELETE. Metadatan manipulointi k√§ytt√§en hyv√§ksi JWT tai cookieta yms. CORS:n v√§√§rin konfiguroiminen, jolloin API:in p√§√§sy v√§√§rilt√§ tahoilta.

## [A10:2021 ‚Äì Server-Side Request Forgery (SSRF)](https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29/)

SSRF puute ilmenee aika websovelluksen hakiessa  et√§resurssia ilman, ett√§ k√§ytt√§j√§n antamaa URL:ia validoidaan. Nyky√§√§n loppuk√§ytt√§j√§t joutuvat websovelluksien nykyisen rakenteen takia t√§llaiseen tilanteeseen, jossa SSRF on mahdollinen ja tapaukset ovat nousussa, koska URL-osoitteen hakeminen on yleist√§.

SSRF on estett√§viss√§ sovelluksen kehitysvaiheessa eri kerrokissa. Network layer (verkkokerros), application layer (sovelluskerros). √Ñl√§ deployaa tietoturvaan liittyvi√§ palveluita frontissa, kuten OpenID:t√§. Frontendiss√§ k√§ytt√§j√§ryhmille verkkojen salaus. My√∂s HTTP uudelleenohjauksen poistaminen. 

## [Access control vulnerabilities and privilege escalation](https://portswigger.net/web-security/access-control)

P√§√§synhallinta tarkoittaa rajoitusten asettamista k√§ytt√§jille. Verkkosovelluksessa se perustuu k√§ytt√§j√§n tunnistamiseen (autentikointi) ja istunnonhallintaan:

Autentikointi varmistaa k√§ytt√§j√§n olevan se kenen pit√§isi olla. Istunnonhallinta tunnistaa, mitk√§ seuraavat HTTP-pyynn√∂t tehd√§√§n samalta k√§ytt√§j√§lt√§. P√§√§synhallinta m√§√§rittelee, onko k√§ytt√§j√§ll√§ oikeus suorittaa toiminto, jota h√§n yritt√§√§ tehd√§. Broken access control on yleinen ja aiheuttaa usein suuria tietoturvariskej√§.



# a) Totally Legit Sertificate

Ladataan OWASP ZAP Download-sivulta sopivin JAR on "Cross Platform Package"

![0](https://github.com/Viktorialissa/PenTest/assets/112398757/dfaebe72-8db5-4e25-aa60-87395bef84f4)


Asennetaan:

  sudo apt-get install openjdk-17-jre

![1](https://github.com/Viktorialissa/PenTest/assets/112398757/3fd7742e-9c0b-410e-81c8-fc4a9ead4a96)

Luodaan uusi hakemisto komennolla:

mkdir zap

Siirret√§√§n zippi tiedosto zap kansioon ja puretaan se
KUVA6

Avataan tiedosto
java -jar <tiedosto>

Aukeaa ja laitetaan enismm√§iseen kohtaan valinta. Sitten painetaan start.

Selain setting hae proxy

Tehd√§√§n sertifikaatti zapilla ja otetaan se k√§ytt√∂√∂n.

# b) Kettumaista

Asennetaan firefoxin lis√§osa foxyproxy.

# PortSwigger Labs
## c) Insecure direct object references

Inspekti auki ja networks sitten hoveroi ladatun tiedoston yll√§ niin polku tulee esiin. Laita urliin se ja vaihda 1.txt

Sitten avaat tiedoston ja n√§et salasanan.
28-31


# Path traversal
## d) File path traversal, simple case
kuva33
kuva 32
## e) File path traversal, traversal sequences blocked with absolute path bypass
KUVA34
## f) File path traversal, traversal sequences stripped non-recursively
KUVA35
# x) Lue/katso ja tiivist√§

# Server Side Template Injection (SSTI)
## g) Server-side template injection with information disclosure via user-supplied objects (T√§m√§ on merkitty hieman vaikeammaksi, j√§t√§ viimeiseksi jos n√§ytt√§√§ hankalalta)


# Server Side Request Forgery (SSRF)
## h) Basic SSRF against the local server


# Cross Site Scripting (XSS)
## i) Reflected XSS into HTML context with nothing encoded
37
## j) Stored XSS into HTML context with nothing encoded
mene comments ja kirjoita sinne <script>alert(1)</script>

t√§yt√§ loput ruudut ja send.
39

## k) Asenna Webgoat 2023.4. (Uusi versio, jossa on eri teht√§vi√§ kuin vanhemmissa)

Aloitin asentamalla palomuurin komennolla

sudo apt-get install ufw

Asennuksen j√§lkeen laitetaan palomuuri p√§√§lle komennolla:

sudo ufw enable

Java oli asennettu jo aikaisemmin, joten sit√§ ei en√§√§ t√§ss√§ viaheessa tarvitse asentaa.

Asennetaan seuraavaksi uusin versio Webgoatista [githubista](https://github.com/WebGoat/WebGoat/releases)

wget https://github.com/WebGoat/WebGoat/releases/download/v2023.4/webgoat-2023.4.jar

OWASP ZAP oli aikaisemmassa teht√§v√§ss√§ asennettu py√∂rim√§√§n porttiin 8080, joten m√§√§ritet√§√§n toinen portti Webgoatille samalla, kun k√§ynnistet√§√§n se javalla k√§ytt√§en komentoa:

java -Dfile.encoding=UTF-8 -Dwebgoat.port=8888 -Dwebwolf.port=9090 -jar webgoat-2023.4.jar

=F@?ozdq4Mt468ip)CwmH4&Nac9d53C"

# Ratkaise WebGoat 2023.4:
## m) (A1) Broken Access Control (WebGoat 2023.4)
### Hijack a session (1)
### Insecure Direct Object References (4)
### Missing Function Level Access Control (3)
### Spoofing an Authentication Cookie (1)
## n) (A7) Identity & Auth Failure (WebGoat 2023.4)
### Authentication Bypasses (1)
### Insecure Login (1)
## o) (A10) Server-side Request Forgery (WebGoat 2023.4)
### Server-Side Request Forgery (2)
## p) Client side (WebGoat 2023.4)
### Bypass front-end restrictions (2)
