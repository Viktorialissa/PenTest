##### Alisa Ahokas

# Hacker Warmup
<!-- Up -->

## Aloitetaan teht√§v√§n tekeminen üìÜ 04.11.2023 üïí 13.00 lukemalla [teht√§v√§nanto](https://terokarvinen.com/2023/eettinen-hakkerointi-2023/#h2).

1. [Fuff](#fuff)
2. [Fuffme](#fuffme)
3. [Porttiskannaa paikallinen kone](#porttiskannaa-paikallinen-kone)
4. [Lue ja tiivist√§](#lue-ja-tiivist√§)
5. [L√§hteet](#l√§hteet)

## Fuff

Ratkaise [Teron ffuf-haastebin√§√§ri](https://terokarvinen.com/2023/fuzz-urls-find-hidden-directories/)

Asennetaan ensin wget komennoilla:

	sudo apt-get update
  	sudo apt-get -y install wget

Ladataan maali ja laitetaan k√§ytt√∂oikeudet (lis√§t√§√§n userille execute oikeus) kuntoon:

 	 wget https://terokarvinen.com/2023/fuzz-urls-find-hidden-directories/dirfuzt-0
 	 chmod u+x dirfuzt-0
 	 ./dirfuzt-0



<details>

<summary>Kuva terminaalista</summary>

![1](https://github.com/Viktorialissa/PenTest/assets/112398757/e83a8890-78e0-4cbd-82d2-9bed674c3ec8)


</details>

Painetaan linkki√§, jonka tiedosto avaa terminaaliin eli ``http://127.0.0.2:8000``. Selaimessa aukeaa sivu, jossa lukee "Nothing, nil, null, nada."


<details>

<summary>Selaimesta kuva</summary>

![2](https://github.com/Viktorialissa/PenTest/assets/112398757/15fb6a17-f52a-4989-a158-3cf6086cf6c7)

</details>

Asennetaan ffuf seuraavilla komennoilla:

	wget https://github.com/ffuf/ffuf/releases/download/v2.0.0/ffuf_2.0.0_linux_amd64.tar.gz
 	tar -xf ffuf_2.0.0_linux_amd64.tar.gz

Parametrit esille komennolla:

	./ffuf
	
<details>

<summary>Kuvia terminaalista</summary>

![3](https://github.com/Viktorialissa/PenTest/assets/112398757/fe575223-2e12-4b32-ba35-e350cd561c6f)
![4](https://github.com/Viktorialissa/PenTest/assets/112398757/4bbed07f-9631-479a-96de-b4ab813f3080)
![5](https://github.com/Viktorialissa/PenTest/assets/112398757/f6ef4a1f-7ef4-4a61-b0b9-db3218af7320)
![6](https://github.com/Viktorialissa/PenTest/assets/112398757/457c320b-0bee-4383-9eab-b631f7a00896)
![7](https://github.com/Viktorialissa/PenTest/assets/112398757/af308287-43ad-4c71-af3e-bc146dca851d)

</details>

Ladataan sanakirja komennolla:

	wget https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/common.txt


<details>

<summary>Kuvia terminaalista</summary>

![8](https://github.com/Viktorialissa/PenTest/assets/112398757/f002ef95-ac63-4e88-814a-aaee13a0450c)


</details>

Otetaan nettiyhteys pois virtuaalikoneesta ennen kuin pyynt√∂j√§ aletaan tekem√§√§n.


<details>

<summary>Nettiyhteys pois</summary>

![9](https://github.com/Viktorialissa/PenTest/assets/112398757/8d6dab1d-aff6-4b4e-a716-e492b2cd2464)
![10](https://github.com/Viktorialissa/PenTest/assets/112398757/680b4901-e4be-4e88-b471-1fa9aab2f156)

</details>

Laitetaan komento
	./ffuf -w common.txt -u http://127.0.0.2:8000/FUZZ

<details>

<summary>Kuva terminaalista</summary>

![11](https://github.com/Viktorialissa/PenTest/assets/112398757/2ee975ab-1a69-4966-ad50-d6d83431a8bd)


</details>

Ohjelma l√§hti skannaamaan hyvin nopeasti ja rivej√§ tuli paljon.

Komento
	./ffuf -w common.txt -u http://127.0.0.2:8000/FUZZ -fs 132

-w viittaa sanalistaan.

-u viittaa url-osoitteeseen, joka on fuzzauksen kohteena.

<details>

<summary>Kuva terminaalista, joss filtter√∂ity haku</summary>

![12](https://github.com/Viktorialissa/PenTest/assets/112398757/d759fbe4-e209-49ee-8040-5231fbc828d7)


</details>

Vastauksia saatiin en√§√§ kaksi eli ``admin`` ja ``render/https://www.google.com``


Menn√§√§n admin endpointtiin ja saadaan esille sivu:

<details>

<summary>Endpointista kuva selaimessa</summary>

![13](https://github.com/Viktorialissa/PenTest/assets/112398757/0d40c2d2-7e06-4281-8e72-ee3614f2e9d1)


</details>


Aloitetaan toisen teht√§v√§n tekemist√§ laittamalla nettiyhteys takaisin p√§√§lle. Kirjoitetaan terminaaliin komennot:

```
  wget https://terokarvinen.com/2023/fuzz-urls-find-hidden-directories/dirfuzt-1
  chmod u+x dirfuzt-1
  ./dirfuzt-1
```
  
<details>

<summary>Nettiyhteys p√§√§lle</summary>

![15](https://github.com/Viktorialissa/PenTest/assets/112398757/fafa56ee-2288-4943-874d-37c68312100f)


</details>

<details>

<summary>Kuva terminaalista</summary>

![17](https://github.com/Viktorialissa/PenTest/assets/112398757/f1939f99-9529-4414-a9ac-921bcf59d4d1)


</details>


Avataan selaimessa painamalla terminaalin linkki√§ ja saadaan auki dirfutz-1 teht√§v√§.

<details>

<summary>Kuva selaimesta</summary>

![16](https://github.com/Viktorialissa/PenTest/assets/112398757/a4d560ec-0d38-4e8f-bd76-b86a902c2d04)


</details>

Otetaan netti taas pois p√§√§lt√§.

Ajetaan komento:

	./ffuf -w common.txt -u http://127.0.0.2:8000/FUZZ


<details>

<summary>Kuva terminaalista</summary>

![19](https://github.com/Viktorialissa/PenTest/assets/112398757/b1496ac9-92d1-48a7-9eb7-37c253414fb6)


</details>

Suodatetaan pois osumia.

Komento 

	./ffuf -w common.txt -u http://127.0.0.2:8000/FUZZ -fs 154

<details>

<summary>Kuvia filtter√∂idyst√§ hausta</summary>


![20](https://github.com/Viktorialissa/PenTest/assets/112398757/8826e90f-1454-40d8-be94-8d07055b208d)
![21](https://github.com/Viktorialissa/PenTest/assets/112398757/acca3aef-05fb-4897-9b5a-2ed1e3448b6f)

</details>


Osumia tuli en√§√§ seitsem√§n ja moni niist√§ liittyi git:iin. L√∂ytyi kuitenkin yksi mielenkiintoinen, jota menin testaamaan selaimeen.

Kirjoitetaan url:iin jatkoksi endpoint ``wp-admin`` ja se l√∂yt√§√§kin sielt√§ flagin.


<details>

<summary>Kuva</summary>

![22](https://github.com/Viktorialissa/PenTest/assets/112398757/96469985-da76-4bab-ab4d-ac1e30772043)


</details>



## Fuffme

Asenna [Ffufme harjoitusmaali](https://terokarvinen.com/2023/fuffme-web-fuzzing-target-debian/) paikallisesti omalle koneellesi. Ratkaise teht√§v√§t:

-Basic Content Discovery
-Content Discovery With Recursion
-Content Discovery With File Extensions
-No 404 Status
-Param Mining
-Rate Limited
-Subdomains - Virtual Host Enumeration

Asennetaan docker komennolla:

	sudo apt-get install docker.io git ffuf

Docker container komennoilla:

```
  git clone https://github.com/adamtlangley/ffufme
  cd ffufme/
  sudo docker build -t ffufme .
```

Maalin ajaminen komennolla:

	sudo docker run -d -p 80:80 ffufme

Menn√§√§n selaimessa localhostiin ja katsotaan, ett√§ maali toimii ja on pystyss√§.

<details>

<summary>Kuvia vaiheista</summary>

![23](https://github.com/Viktorialissa/PenTest/assets/112398757/5b03b769-93ff-46d3-94c8-5454b695b843)
![24](https://github.com/Viktorialissa/PenTest/assets/112398757/0d2b1f0b-694d-47d8-9cc7-bbd8d7834fcb)
![25](https://github.com/Viktorialissa/PenTest/assets/112398757/9169680e-aee2-4c22-9584-edbc3f32a136)

![26](https://github.com/Viktorialissa/PenTest/assets/112398757/660e338c-df59-4b33-b3e7-63a3add2db2b)

</details>


Asennetaan sanalistat komennoilla:

 ```
  mkdir $HOME/wordlists
  cd $HOME/wordlists
  wget http://ffuf.me/wordlist/common.txt
  wget http://ffuf.me/wordlist/parameters.txt 
  wget http://ffuf.me/wordlist/subdomains.txt
  cd -
```

<details>

<summary>Kuvia terminaalista</summary>

![27](https://github.com/Viktorialissa/PenTest/assets/112398757/8ecc3511-f6c0-4a12-93b9-403041aea47f)
![28](https://github.com/Viktorialissa/PenTest/assets/112398757/b9a3f436-0c75-4a45-84a3-9fc6c33fcbb6)
![29](https://github.com/Viktorialissa/PenTest/assets/112398757/48d20d4d-f0ad-4f6d-a796-b7448dd54f2c)


</details>


Nyt katkaisen taas nettiyhteyden.


### Basic:

<details>

<summary>Kuva teht√§v√§st√§ selaimessa</summary>

![31](https://github.com/Viktorialissa/PenTest/assets/112398757/e8da2c62-ffa9-4a2e-a249-0f9c42a1b7cb)

</details>

Kirjoitetaan terminaaliin komento:

	ffuf -w $HOME/wordlists/common.txt -u http://localhost/cd/basic/FUZZ

<details>

<summary>Kuva terminaalista</summary>

![32](https://github.com/Viktorialissa/PenTest/assets/112398757/dfe078af-9fff-402d-8a5f-a9806aa79039)


</details>

Pit√§isi l√∂yty√§ ``class`` ja ``development.log`` ja ne l√∂ytyiv√§t.
Class endpointia k√§ytet√§√§n. Ja l√∂ydet√§√§n oikea tiedosto.

<details>

<summary>Kuva selaimesta</summary>

![33](https://github.com/Viktorialissa/PenTest/assets/112398757/93a7b1cf-71c0-4e6e-90de-c62531668ba2)


</details>



### Recursion:

<details>

<summary>Kuva teht√§v√§st√§</summary>

![34](https://github.com/Viktorialissa/PenTest/assets/112398757/29829797-35cd-4e31-9b45-3d4db9052c87)

</details>

Kirjoitetaan terminaaliin komento:

	ffuf -w ~/wordlists/common.txt -recursion -u http://localhost/cd/recursion/FUZZ

<details>

<summary>Kuva terminaalista</summary>

![35](https://github.com/Viktorialissa/PenTest/assets/112398757/3c37e829-53af-4fba-8a69-d65f1ece9522)


</details>



Recursion auttaa hakemiston l√∂ytyess√§ sen sis√§ll√§ skannauksen jatkumiseen eli l√∂yt√§ess√§√§n hakemiston se jatkaa fuzzaamista sen sis√§ll√§ jne. L√∂ydettiin endpointit admin, users ja 96. Kirjoitetaan urliin admin/users/96 ja l√∂ydettiin tiedosto.

<details>

<summary>Kuva selaimesta</summary>

![36](https://github.com/Viktorialissa/PenTest/assets/112398757/35e30bcf-6ab7-4af9-8c52-9bf75e38b8d3)


</details>

### Content Discovery - File Extensions

<details>

<summary>Kuva teht√§v√§st√§</summary>

![37](https://github.com/Viktorialissa/PenTest/assets/112398757/f32b7532-9449-458b-be8f-d4ca85850d1c)


</details>


Kirjoitetaan terminaaliin komento:

	ffuf -w ~/wordlists/common.txt -e .log -u http://localhost/cd/ext/logs/FUZZ

<details>

<summary>Kuv terminaalistaa</summary>

![38](https://github.com/Viktorialissa/PenTest/assets/112398757/297c85b7-d639-4be4-a0ba-8d7991a97555)


</details>


users.log l√§ydettiin.


### Content Discovery - No 404 Status

<details>

<summary>Kuva teht√§v√§st√§</summary>

![39](https://github.com/Viktorialissa/PenTest/assets/112398757/87a3b510-82af-41d2-91d9-fe531c29a09b)


</details>

Kirjoitetaan komento:

	ffuf -w ~/wordlists/common.txt -u http://localhost/cd/no404/FUZZ

Ja saadaan aika paljon tuloksia. Jatketaan teht√§v√§nannon mukaan ja kirjoitetaan komento:

	ffuf -w ~/wordlists/common.txt -u http://localhost/cd/no404/FUZZ -fs 669

<details>

<summary>Kuva terminaalista</summary>

![40](https://github.com/Viktorialissa/PenTest/assets/112398757/c5993530-e44e-404b-8c67-586bd3a8aa62)


</details>


Saadaan huomattavasti v√§hemm√§n tuloksia, koska filtter√∂itiin 669 kokoiset pois ja j√§i j√§ljelle haluttu ``secret``.

<details>

<summary>Kuva selaimesta</summary>

![41](https://github.com/Viktorialissa/PenTest/assets/112398757/5c47f978-fa95-4f03-82b4-3565cb6cbd70)


</details>


### Content Discovery - Param Mining

<details>

<summary>Kuva teht√§v√§st√§</summary>

![42](https://github.com/Viktorialissa/PenTest/assets/112398757/9a792022-423d-4d00-bce5-b50b1c345148)


</details>

Kirjoitetaan komento:

	ffuf -w ~/wordlists/parameters.txt -u http://localhost/cd/param/data?FUZZ=1

Saadaan kadonnut parametri eli debug. Sijoitetaan se urliin. Selain n√§ytt√§√§, ett√§ homma toimi.


<details>

<summary>Kuva terminaalista aj selaimesta</summary>

![43](https://github.com/Viktorialissa/PenTest/assets/112398757/6245196d-aab1-4a1f-92a5-599bfface716)
![44](https://github.com/Viktorialissa/PenTest/assets/112398757/4600faa3-7c4f-402d-b844-13173754823f)

</details>


### Content Discovery - Rate Limited

<details>

<summary>Kuva teht√§v√§st√§</summary>

![45](https://github.com/Viktorialissa/PenTest/assets/112398757/fe339fe0-944d-46f9-bd7b-25524a7cda5e)


</details>

Kirjoitetaan terminaaliin ensin komento:

	ffuf -w ~/wordlists/common.txt -u http://localhost/cd/rate/FUZZ -mc 200,429

Ja sen j√§lkeen komento:

	ffuf -w ~/wordlists/common.txt -t 5 -p 0.1 -u http://localhost/cd/rate/FUZZ -mc 200,429

Vaihdetaan teht√§v√§nannosta verkkosivuksi localhost.

<details>

<summary>Kuva terminaalista</summary>

![46](https://github.com/Viktorialissa/PenTest/assets/112398757/d864d904-0ad9-4912-9463-f9a51816fb91)


</details>


Kirjoitetaan selaimeen urliin enpointiksi ``oracle``.

<details>

<summary>Kuva selaimesta</summary>

![47](https://github.com/Viktorialissa/PenTest/assets/112398757/d362f7ff-d024-4b2c-9112-33173b20625d)


</details>

### Subdomains - Virtual Host Enumeration

<details>

<summary>Kuva teht√§v√§st√§</summary>

![48](https://github.com/Viktorialissa/PenTest/assets/112398757/530ce07a-211f-4099-92de-5d08621dce71)


</details>

Kirjoitetaan terminaaliin komento:

	ffuf -w ~/wordlists/subdomains.txt -H "Host: FUZZ.ffuf.me" -u http://localhost

Saadaan paljon tuloksia ja filtter√∂id√§√§n kirjoittamalla komento:

	ffuf -w ~/wordlists/subdomains.txt -H "Host: FUZZ.ffuf.me" -u http://localhost -fs 1495

Nyt saadaan vain yksi tulos en√§√§, joka on redhat. L√∂ydettiin yksi aladomain ``redhat``.


<details>

<summary>Kuva terminaalista</summary>

![49](https://github.com/Viktorialissa/PenTest/assets/112398757/2183c45e-3252-464e-80c6-1ba7a748257b)


</details>





## Porttiskannaa paikallinen kone

Porttiskannaa paikallinen kone (127.0.0.2 tms), sieppaa liikenne snifferill√§, analysoi.

Asennetaan teht√§v√§√§ varten wireshark komennolla:

	sudo apt-get install wireshark

Vastataan kysymykseen YES, joka liittyy non-root useriin.

<details>

<summary>Kysymys terminaalissa</summary>

![50](https://github.com/Viktorialissa/PenTest/assets/112398757/0c7951da-4b1e-4289-a982-eb3f5f1ac2e7)


</details>


K√§ynnistet√§√§n wireshark ja aloitetaan teht√§v√§n tekeminen.

### c) nmap TCP connect scan -sT

Kirjoitetaan komento:

	sudo nmap -sT 127.0.0.2

<details>

<summary>Kuva wiresharkista</summary>

![52](https://github.com/Viktorialissa/PenTest/assets/112398757/a4c6690e-bdce-4633-903a-133284b832aa)


</details>



Terminaalissa skannausraportti oli seuraava:

```
Starting Nmap 7.93 ( https://nmap.org ) at 2023-11-04 17:37 EET
Nmap scan report for 127.0.0.2
Host is up (0.00017s latency).
Not shown: 998 closed tcp ports (conn-refused)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http

Nmap done: 1 IP address (1 host up) scanned in 0.10 seconds

```

Nmapin versio ja p√§iv√§m√§√§r√§ sek√§ aika, jolloin skannaus on tehty. Skannausraportti kertoo, mik√§ on skannattu ja host on ylh√§√§ll√§.
N√§ytt√§√§, ett√§ 2 porttia (22 ja 80) on auki ja toisessa on ssh py√∂rim√§ss√§ ja toisessa on http. 998 porttia on kiinni.

SYN paketti l√§htee 127.0.0.1:st√§ 127.0.02:een. Vastauksena 2 l√§hett√§√§ 1:lle RST, ACK paketin, koska se on kiinni. SYN eli synchronize t√§ss√§ vaiheessa pyydet√§√§n aloittamaan yhteydenmuodostus kohteelta eli 127.0.0.2:lta, joka vastaa RST eli reset ja ACK eli acknowledge ja n√§m√§ kertovat yhteyden muodostuksen ep√§onnistuneen ja nollaamisen. 


Kokeillaan viel√§ avointa porttia 22:

	sudo nmap -sT -p 22 127.0.0.2


Nyt vastaus on erilainen ja vastauskena tulee SYN ja ACK paketit. Kolmivaiheinen k√§ttely alkaa ensimm√§isest√§ SYN paketista rivill√§ 1 ja jatkuu rivilt√§ 2, joka tarkoittaa kohteen olevan valmis aloittamaan yhteydenpidon. Rivi 3 n√§ytt√§√§, ett√§ l√§hde on vahvistanut saaneensa SYN ja ACK -paketit l√§hett√§m√§ll√§ itse ACK-paketin. Kolmivaiheinen k√§ttely on siis tehty ja yhteys on p√§√§ll√§. Rivi 4 lopettaa yhteyden.

<details>

<summary>Wireshark portista 22</summary>

![53](https://github.com/Viktorialissa/PenTest/assets/112398757/1cf7c84e-f228-4d47-9232-368a6c0ee1f6)


</details>



### d) nmap TCP SYN "used to be stealth" scan, -sS 

Jatketaan portin 22 kanssa ja kirjoitetaan terminaaliin:

	sudo nmap -sS -p 22 127.0.0.2

Terminaalin skannausraportti on vastaavanlainen ylemm√§n kanssa.

```
Starting Nmap 7.93 ( https://nmap.org ) at 2023-11-04 18:44 EET
Nmap scan report for 127.0.0.2
Host is up (0.00014s latency).

PORT   STATE SERVICE
22/tcp open  ssh

Nmap done: 1 IP address (1 host up) scanned in 0.20 seconds
```

Wireshark nappaa liikenteen ja on kohtuullisen samanlainen kuin ylh√§√§ll√§. Rivit 1-3 aloittavat kolmivaiheisen k√§ttelyn, mutta kolmannella rivill√§ yhteys katkaistaan eli toimivaa yhteytt√§ ei muodostettu. -sS komennolla TCP-yhteytt√§ ei vied√§ loppuun asti toisin kuin yll√§.

<details>

<summary>Kuva wiresharkista</summary>

![54](https://github.com/Viktorialissa/PenTest/assets/112398757/9219ba1a-468d-4b19-b325-304aa53c80b7)


</details>


### e) nmap ping sweep -sn

Kirjoitetaan terminaaliin komento:

	sudo nmap -sn 127.0.0.2



pingatessa en saanut liikennett√§ wiresharkiin.

<details>

<summary>Kuva wiresharkista</summary>

![55](https://github.com/Viktorialissa/PenTest/assets/112398757/b2443b82-7a9c-4a43-9dd2-a274f408f542)


</details>

### f) nmap don't ping -Pn

Kirjoitetaan terminaaliin komento:

	sudo nmap -Pn 127.0.0.2

Komento skannaa portit (skannausraportti terminaalissa) ja wiresharkissa n√§kyy liikennett√§, jossa yhteytt√§ ei ikin√§ aloiteta. -Pn ohittaa pingauksen eli suorittaa porttiskannauksen ilman testi√§ onko hostkone elossa vai ei.

<details>

<summary>Kuva terminaalista aj wiresharkista</summary>

![56](https://github.com/Viktorialissa/PenTest/assets/112398757/fed755ba-041a-4f95-aca4-da297b633065)
![57](https://github.com/Viktorialissa/PenTest/assets/112398757/0aee1359-aecb-46c2-9775-f2b49bbca62b)

</details>

### g) nmap version detection -sV 

Kirjoitetaan terminaaliin komento:

	sudo nmap -sV -p 22 127.0.0.2


Rivit 1-3 yritt√§√§ muodostaa yhteyden, mutta ep√§onnistuu. Rivill√§ 4 alkaa uudelleen yhteyden muodostus, joka onnistuu rivin 4-6 mukaan. Rivill√§ 7 tunnistetaan SSH-protokolla ja sen versionumeron (Server: Protocol (SSH-2.0-OpenSSH_9.2p1 Debian-2+deb12u1))

Rivit 9-12. FIN, ACK -paketit ilmoittavat yhteyden sulkeutumisesta keskustellen.

<details>

<summary>Kuva terminaalista ja wiresharkista</summary>


![58](https://github.com/Viktorialissa/PenTest/assets/112398757/70e082d8-3f54-46f1-824f-0dbafc3edf7a)
![59](https://github.com/Viktorialissa/PenTest/assets/112398757/c0c4e3d8-46ba-4652-b5c6-124c8c101665)

</details>


### h) nmap output files -oA foo

Kirjoitetaan terminaaliin komento:

	sudo nmap -oA foo -p 22 127.0.0.2


<details>

<summary>Kuva terminaalista</summary>

![60](https://github.com/Viktorialissa/PenTest/assets/112398757/8f7abed3-8b5a-40d1-8239-f26f62b23dc5)


</details>


Wireshark nappasi liikennett√§, jossa taas avataan yhteys, mutta ennen yhteydenmuodostusta se lopetetaan.

<details>

<summary>Kuva wiresharkista</summary>

![61](https://github.com/Viktorialissa/PenTest/assets/112398757/4f54fc4e-7e9e-4d4d-a398-5083957f16e9)


</details>


Kirjoitetaan terminaalin komento ``ls`` jotta n√§hd√§√§n kaikki tiedostot.

Avataan muodostunut foo.nmap tiedosto komennolla:

	cat foo.nmap


Tiedostossa n√§kyy kaikki tiedot sek√§ komento, joka on suoritettu tiedoston muodostumiseen.

<details>

<summary>Kuva terminaalista</summary>

![62](https://github.com/Viktorialissa/PenTest/assets/112398757/8bc5b310-c7db-4b82-8ac1-6f1d2da5b7f6)


</details>


### i) nmap ajonaikaiset toiminnot 

K√§ytet√§√§n komentoa:

	sudo nmap -sS -p 22 127.0.0.2

Sielt√§ saadaan painamalla, jotain n√§pp√§int√§ n√§pp√§imist√∂st√§ eritt√§in nopeasti, Stats-osa.

<details>

<summary>Kuva terminaalista</summary>

![63](https://github.com/Viktorialissa/PenTest/assets/112398757/f5813daa-2a1b-4dc3-b3f7-90fbf7ee1a9b)


</details>


Nmapia suoritettaessa tallentuu kaikki painallukset n√§pp√§imist√∂st√§. Voit vaikuttaa ohjelmaan samalla, kun se on p√§√§ll√§ ja suorittaa skannausta. Monet n√§pp√§imet (paitsi alla luetellut) tulostavat Stats-viestin, joka kertoo skannauksen tilan. Pienet kirjaimet lis√§√§v√§t tulostuksen m√§√§r√§√§ ja isot kirjaimet v√§hent√§v√§t tulostusta. Painaessasi '?' voit saada apua.

```
  v / V
  Lis√§√§ / v√§henn√§ tulostuksen yksityiskohtaisuuden tasoa

  d / D
  Lis√§√§ / v√§henn√§ debuggauksen tasoa

  p / P
  Kytke p√§√§lle / pois p√§√§lt√§ pakettien j√§ljitys

  ?
  Tulostaa ohjelman suorituksen aikaisen ohjen√§yt√∂n
```

###  Ninjojen tapaan. Piiloutuuko nmap-skannaus hyvin palvelimelta?

Aloitetaan asentamalla apache komennolla:

	sudo apt-get install apache2

Latauksen j√§lkeen potkaistaan demoni k√§yntiin komennolla

	sudo systemctl start apache2

Apache ei k√§ynnistynyt, koska portti oli jo k√§yt√∂ss√§. Skannataan portti komennolla:

	sudo nmap -sT -p 80 127.0.0.2

Varmistettu asia ja tajusin dockerin py√∂riv√§n portissa 80 aiemman teht√§v√§n takia. Sammutetaan docker komennolla:

	sudo systemctl disable --now docker

Tehd√§√§n sama skannaus uudelleen, jotta n√§hd√§√§n, ett√§ portti on nyt kiinni.

<details>

<summary>Kuva terminaalista</summary>

![64](https://github.com/Viktorialissa/PenTest/assets/112398757/c443d10c-0db3-4a48-a627-72866b627a1f)


</details>


Yritet√§√§n nyt k√§ynnist√§√§ apache uudelleen komennolla:

	sudo systemctl start apache2

Nyt terminaalissa ei tullut herjausta, joten varmistetaan se viel√§ katsomalla status komennolla:

	sudo systemctl status apache2

<details>

<summary>Kuva apachesta py√∂rim√§ss√§</summary>

![65A](https://github.com/Viktorialissa/PenTest/assets/112398757/a229273b-03b5-40f1-80ad-bbdae5a731e7)

![65](https://github.com/Viktorialissa/PenTest/assets/112398757/93be4522-c26e-4020-9f5f-e27885eaa70d)


</details>

K√§ytet√§√§n skannauksessa komentoa:

	sudo nmap -sV  localhost

<details>

<summary>Kuva terminaalista</summary>

![66](https://github.com/Viktorialissa/PenTest/assets/112398757/b10d76c5-492f-4ca5-9ebd-85560897132d)


</details>


Skannaus n√§ytt√§√§ apachen olevan k√§ynniss√§ portissa 80.

Laitetaan wiresharkiin filtteriksi http ennen skannausta. Skannauksen k√§ynnistyess√§ wireshark nappaa http-liikennett√§ liittyen apacheen.

<details>

<summary>Kuva wiresharkista</summary>

![67](https://github.com/Viktorialissa/PenTest/assets/112398757/c85f45d5-a31e-43a2-a17e-46a4a7bdcb01)


</details>


Avataan apachen acces-loki komennolla:

	sudo cat /var/log/apache2/access.log

Sielt√§ voidaan n√§hd√§ j√§lki√§ skannauksesta kohdissa, joissa on nmap.

<details>

<summary>Kuva apachen lokista</summary>

![68](https://github.com/Viktorialissa/PenTest/assets/112398757/108657cc-1795-48d9-b440-b11d42645ddc)


</details>


### UDP-skannaus. UDP-skannaa paikkalinen kone (-sU)

Tehd√§√§n skannaus k√§ytt√§m√§ll√§ komentoa:

	sudo nmap -sU 127.0.0.2

Terminaalin skannausraportti kertoo j√§lleen nmapin version ja skannauksen ajankohdan sek√§ mit√§ on skannattu. Host on ylh√§√§ll√§ ja 998 udp porttia on kiinni ja kaksi on auki. 631, joka k√§ytt√§√§ ipp-palvelua sek√§ portti 5353, joka k√§ytt√§√§ zeroconf-palvelua (Zero-configuration networking - mahdollistaa verkkolaitteiden helpomman liitt√§misen ja konfiguroinnin paikallisessa verkossa ilman manuaalista ty√∂t√§ tai konfiguraatioita.).

<details>

<summary>Kuva terminaalista</summary>

![69](https://github.com/Viktorialissa/PenTest/assets/112398757/67c59554-3631-4ce1-8550-c74a1a8a853b)


</details>

Wireshark kertoo kohteista, jotka eiv√§t ole olleet saavutettavissa.

<details>

<summary>Kuva wiresharkista</summary>

![70](https://github.com/Viktorialissa/PenTest/assets/112398757/1a8bfaa0-f924-4703-9c11-3fc30465f89a)


</details>



### Miksi UDP-skannaus on hankalaa ja ep√§luotettavaa? Miksi UDP-skannauksen kanssa kannattaa k√§ytt√§√§ --reason flagia ja snifferi√§? 

Snifferin ja --reason flagin k√§yt√∂t saattavat auttaa selvitt√§m√§√§n udp-skannauksen tulosta, joka on muuten kohtuullisen ep√§luotettava. --reason kertoo syyn, miksi nmap luokitteli portin niinkuin luokitteli. Skannatessa palvelu l√§hett√§√§ geneerisen UDP-paketin ja odottaa vastausta. Jos vastausta ei tule, oletetaan portin olevan auki. Jos ICMP error -paketti tuleekin vastauksena oletetaan portin olevan kiinni.

## Lue ja tiivist√§.

Avoin - TCP-yhteyksien aktiivinen hyv√§ksynt√§. Skannauksessa on tavoitteena avointen porttien l√∂yt√§minen. Avoin portti mahdollistaa aina hy√∂kk√§yksen.

Suljettu - Suljettu portti on saavutettavissa, mutta siin√§ ei ole sovellusta k√§ynniss√§. Suljettujen porttien uudelleen skannaus voi olla hy√∂dyllist√§, koska ne saatetaan avata my√∂hemmin.

Filtter√∂ity/Suodatettu - Nmap ei tied√§, onko portti auki vai ei, koska se on voitu suojata palomuurilla. T√§m√§ ei anna hy√∂kk√§√§j√§lle paljon tietoa. Nmap yritt√§√§ skannausta useaan otteeseen hidastaen sit√§ merkitt√§v√§sti.

-sS eli (TCP SYN scan) SYN-skannaus on suosituin skannausvaihtoehto. Nopea ja suhteellisen huomaamaton, koska j√§tt√§√§ TCP-yhteyden muodostumisen loppuun asti kesken. Ensin tiedustellaan, onko portti auki (SYN). Sitten palvelu vastaa (SYN/ACK) ja vastauksen j√§lkeen yhteys katkaistaan (RST).

-sT eli (TCP connect scan) toimii vaihtoehtona, jos SYN-skannaus ei ole. Muodostaa TCP-yhteyden kokonaan ja kohdekoneet logittavat skannauksen todenn√§k√∂isemmin t√§t√§ k√§ytett√§ess√§. T√§m√§ vie siis kauemmin aikaa, koska paketteja liikkuu enemm√§n.

-sU eli (UDP scans) UDP-skannaus vie enemm√§n aikaa ja on hankalampaa kuin TCP, kuitenkin tietoturvan silmin UDP-skannaus on my√∂s t√§rke√§√§. UDP-skannaus voidaan tehd√§ samaa aikaa kuin TCP-skannaus. UDP-skannauksessa UDP-paketti l√§hetet√§√§n kaikkiin portteihin ja vastauksena voi tulla ICMP-paketti, mik√§ kertoo portin olevan saavuttamattomissa. Jos vastauksena ei tule mit√§√§n, voidaan tulkita portti avoimeksi.



> Lopetetaan teht√§vien tekeminen ja raportin koostaminen üìÜ 04.11.2023 üïí 21.15


## L√§hteet:

L√ÑHDE: Find Hidden Web Directories - Fuzz URLs with ffuf
https://terokarvinen.com/2023/fuzz-urls-find-hidden-directories/

Fuffme - Install Web Fuzzing Target on Debian
https://terokarvinen.com/2023/fuffme-web-fuzzing-target-debian/

L√ÑHDE Zero-configuration networking
https://en.wikipedia.org/wiki/Zero-configuration_networking



- Tero Karvinen luento 30.10.2023.
- [Tero Karvinen - teht√§v√§](https://terokarvinen.com/2023/eettinen-hakkerointi-2023/#h2). Luettu 04.11.2023.

